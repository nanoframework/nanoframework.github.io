<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
      <title>&#127798;️ - Reading an AM2320 I2C Temerature and Humidity sensor | .NET nanoFramework Documentation </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="&#127798;️ - Reading an AM2320 I2C Temerature and Humidity sensor | .NET nanoFramework Documentation ">
      
      
      <link rel="icon" href="../../../favicon.ico">
      <link rel="stylesheet" href="../../../public/docfx.min.css">
      <link rel="stylesheet" href="../../../public/main.css">
      <meta name="docfx:navrel" content="../../../toc.html">
      <meta name="docfx:tocrel" content="../../../x-cross/toc.html">
      
      <meta name="docfx:rel" content="../../../">
      
      
      <meta name="docfx:docurl" content="https://github.com/nanoframework/Samples/blob/main/samples/Beginner/TempHumI2c/README.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../../../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../../index.html">
            <img id="logo" class="svg" src="../../../logo.svg" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="---reading-an-am2320-i2c-temerature-and-humidity-sensor">🌶️ - Reading an AM2320 I2C Temerature and Humidity sensor</h1>

<p>Shows how to use the <a href="https://docs.nanoframework.net/api/System.Device.I2c.html">System.Device.I2c</a> API to use Inter-Integrated Circuit (I2C).</p>
<p>We will use an AM2320 temperature and humidity I2C sensor. We will connect pin 21 to the Data pin (called often SDA) and 22 to the Clock pin (called often SCL). Plus 3.3V to VCC and Ground to Ground. Note that ESP32 have an internal pull-up resistor for the I2C bus. It's not the case for all the MCU. You may have to add one between the Data and Clock pin and the the VCC pin. In the case of 3.3V, 1.8 K ohms will be perfect.</p>
<p><img src="../../../samplesimages/Beginner/Docs/schema_am2320.png" alt="schema"></p>
<p>And if you want to know more about I2C and why we need pull-up resistors, how this works, you can read the <a href="https://docs.nanoframework.net/content/getting-started-guides/i2c-explained.html">All what you've always wanted to know about I2C</a> content!</p>
<h2 id="running-the-sample">Running the sample</h2>
<p>Ensure you have all the <a href="../README.html">software requirements</a>.</p>
<p>To build the sample, follow the section <a href="../README.html">here</a>. And to run it, <a href="../README.html#run-the-sample">here</a>.</p>
<p>The sample is <a href="https://github.com/nanoframework/Samples/tree/main/samples/Beginner/TempHumI2c/Program.cs">located here</a>. The code is very straightforward with the explanations:</p>
<pre><code class="lang-csharp">using Iot.Device.Am2320;
using nanoFramework.Hardware.Esp32;
using System.Device.I2c;
using System.Diagnostics;
using System.Threading;

Debug.WriteLine(&quot;Hello from AM2320!&quot;);

//////////////////////////////////////////////////////////////////////
// when connecting to an ESP32 device, need to configure the I2C GPIOs
// used for the bus
Configuration.SetPinFunction(21, DeviceFunction.I2C1_DATA);
Configuration.SetPinFunction(22, DeviceFunction.I2C1_CLOCK);

// If you are using another I2C temperature and humidity sensor, you will have to adjust the name of the class.
// You will also have to adjust the I2C address if it is different.
using Am2320 am2330 = new(new I2cDevice(new I2cConnectionSettings(1, Am2320.DefaultI2cAddress, I2cBusSpeed.StandardMode)));

while (true)
{
    // Most temperature and humidity sensors have a temperature and humidity property.
    var temp = am2330.Temperature;
    var hum = am2330.Humidity;

    // In most of the cases, you will have to check if the last read was successful.
    // It happens that a read fails because of a timing issue for example.
    if (am2330.IsLastReadSuccessful)
    {
        Debug.WriteLine($&quot;Temp = {temp.DegreesCelsius} C, Hum = {hum.Percent} %&quot;);
    }
    else
    {
        Debug.WriteLine(&quot;Not sucessfull read&quot;);
    }

    // And it's important to wait a little bit before reading again.
    // All sensors have a limit, it's important to check the datasheet.
    // In our case, we usually have a property like this one.
    Thread.Sleep(Am2320.MinimumReadPeriod);
}
</code></pre>
<p>And as a result, you will see:</p>
<pre><code class="lang-text">Hello from AM2320!
Temp = 28.3 C, Hum = 36.9 %
Temp = 28.5 C, Hum = 36.299999999999999 %
Temp = 28.5 C, Hum = 36 %
Temp = 28.5 C, Hum = 35.6 %
Temp = 28.5 C, Hum = 35.299999999999998 %
Temp = 28.5 C, Hum = 35.1 %
Temp = 28.5 C, Hum = 34.899999999999998 %
Temp = 28.5 C, Hum = 34.5 %
Temp = 28.5 C, Hum = 34.5 %
Temp = 28.399999999999999 C, Hum = 33.6 %
Temp = 28.399999999999999 C, Hum = 33.299999999999996 %
Temp = 28.399999999999999 C, Hum = 33 %
Temp = 28.3 C, Hum = 33 %
</code></pre>
<p>If you want to debug, follow the instructions <a href="../BlinkLed/README.html">explained in the led sample</a>.</p>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/nanoframework/Samples/blob/main/samples/Beginner/TempHumI2c/README.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>


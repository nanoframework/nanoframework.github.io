<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Troubleshooting device connection | .NET nanoFramework Documentation </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Troubleshooting device connection | .NET nanoFramework Documentation ">
    <meta name="generator" content="docfx ">
  
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../../x-cross/toc.html">
  
  <meta property="docfx:rel" content="../../">
  
  </head>
  <body data-spy="scroll" data-target="#affix">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>

        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">

        <div id="search-results">
          <div class="search-list"></div>
          <div class="sr-items"></div>
          <ul id="pagination"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">

        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="troubleshooting-device-connection">Troubleshooting device connection</h1>

<p>Sometimes, you may have problem with a device. You may have hard time to find it, hard time to flash it and after flash you may not find it in the Visual Studio extension. So this article is for you and will give you elements to figure out the root cause.</p>
<p>This example will use an ESP32 device but it works in a similar way for other devices.</p>
<h2 id="assumptions">Assumptions</h2>
<p>We assume you have properly installed the .NET nanoFramework flash tool called <code>nanoff</code>. If not, go <a href="https://github.com/nanoframework/nanoFirmwareFlasher">here</a>.</p>
<p>We also assume you have properly installed the Visual Studio Extension. If not the case, then go <a href="getting-started-managed.html">here</a>.</p>
<p>And finally, we assume you have a tool to watch port serial traffic like <code>putty</code>. If you don't have any, go <a href="https://www.chiark.greenend.org.uk/%7Esgtatham/putty/latest.html">here</a>.</p>
<h2 id="finding-the-serial-port-of-your-device">Finding the serial port of your device</h2>
<p>The main trick here is to run 2 times the following command: <code>nanoff --listports</code></p>
<h3 id="finding-ports-on-windows">Finding ports on Windows</h3>
<p>The first time it will look like this on Windows:</p>
<p><img src="../../images/getting-started-guides/trb-listports.png" alt="list ports empty"></p>
<p>Then once you plug your device and rerun the command, you will see your port:</p>
<p><img src="../../images/getting-started-guides/trb-listports-found.png" alt="list ports found"></p>
<p>In this case, the com port is <code>COM3</code> on Windows. Bravo!</p>
<p>In case you don't see anything at all, then make sure you have the proper drive installed. If you don't have the proper driver installed, you'll get in the device explorer an error. If all is properly installed, you'll also be able to find the port:</p>
<p><img src="../../images/getting-started-guides/getting-started-find-com-port.gif" alt="Finding COM Port"></p>
<h3 id="finding-ports-on-linuxmacos">Finding ports on Linux/MacOS</h3>
<p>And like this on MacOS/Linux with no device plugged in:</p>
<p><img src="../../images/getting-started-guides/trb-listports-mac.png" alt="list ports empty"></p>
<p>Once you plug the device, you'l get the port details:</p>
<p><img src="../../images/getting-started-guides/trb-listports-found-mac.png" alt="list ports found"></p>
<p>We'll use the tty one, so <code>/dev/tty.usbserial-531F00209021</code>. The naming can be very different depending on the device you are using. In all the cases, make sure the latest drivers are installed.</p>
<p>In case you won't find your device, it's recommended to install <code>lsusb</code>. For linux, depending on the version, just use <code>apt-get install lsusb</code> and for MacOS <code>brew install lsusb</code> (you may have to use higher privileges using <code>sudo</code>).</p>
<p>Then similar to using the nanoff command, unplug your device and run <code>lsusb</code> to list the connected devices. Run it a second time with the device connected to figure out what it is and which drivers are required. The result will looks like this:</p>
<p><img src="../../images/getting-started-guides/trb-lsusb.png" alt="lsusb empty"></p>
<p>And with the added device:</p>
<p><img src="../../images/getting-started-guides/trb-lsusb-found.png" alt="lsusb empty"></p>
<p>You can refer to the hardware found and then to the vendor to find out what drivers are needed.</p>
<h2 id="my-device-flashes-but-i-cant-find-it-in-visual-studio-extension">My device flashes but I can't find it in Visual Studio extension</h2>
<p>You've flashed the device successfully using <code>nanoff</code> but you don't see it in the Visual Studio Extension.</p>
<p>First, check <a href="trouble-shooting-guide.html">this troubleshooting guide</a>!</p>
<p>Still nothing? OK, let's debug the device itself.</p>
<h3 id="special-esp32">Special ESP32</h3>
<p>ESP32 devices at boot time will output quite a lot of things. For this, you need to connect your deviceESP32 with the proper serial port (in the previous example <code>COM3</code> for Windows and <code>/dev/tty.usbserial-531F00209021</code> for Linux/Mac) with a baud rate of 115200.</p>
<p><img src="../../images/getting-started-guides/trb-config-putty.png" alt="putty config"></p>
<p>And when you connect <strong>and</strong> reset the device by pressing the little EN or BOOT or equivalent button of your ESP32, you'll get a result like this:</p>
<p><img src="../../images/getting-started-guides/trb-esp32-boot.png" alt="putty ESP32 outcome"></p>
<p>If your device is ok, you should see all green, no red lines. If you have red lines, it may be related to an issue, that can point you on something broken in your device. If the device reboots all the time, you'll get this screen over and over, it then means the device can be out of order or you have a problem with the image.</p>
<p>If at this point all is good for your device, go to the next step.</p>
<h3 id="finding-if-nanoframework-booted">Finding if nanoFramework booted</h3>
<p>To know if your device boots properly, use putty or equivalent and open the serial port your device is connected to with the baud rate of <code>921600</code>, this is the baud rate used by <code>Console.WriteLine</code> or <code>Debug.WriteLine</code> and whenever you have exceptions or equivalent raised by the CLR.</p>
<p><img src="../../images/getting-started-guides/trb-putty-921600.png" alt="putty config"></p>
<p>Regardless of your device, once you connect it, you will see the message <code>NFPKTV1</code> appearing. This means that .NET nanoFramework is properly loaded and working. To see it, you may have to reboot your device by pressing buttons like EN, RST, BOOT or equivalent.</p>
<p><img src="../../images/getting-started-guides/trb-nano-booted.png" alt="putty config"></p>
<p>Don't worry about the possible scramble characters before, they are the ones from the boot of the device itself. Some devices like ESP32 are quite chatty (see previous section), some devices like STM32 are very quite!</p>
<p>From that point, seeing this message means the device is properly working, so look again at <a href="trouble-shooting-guide.html">this troubleshooting guide</a>.</p>
</article>
          </div>

          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/nanoframework/nanoframework.github.io/blob/pages-source/content/getting-started-guides/troubleshooting-device-connection.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      
      <span>Copyright © 2018 nanoFramework Contributors<br>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>

    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>

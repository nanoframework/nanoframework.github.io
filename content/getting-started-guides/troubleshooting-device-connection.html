<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
      <title>Troubleshooting device connection | .NET nanoFramework Documentation </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Troubleshooting device connection | .NET nanoFramework Documentation ">
      
      
      <link rel="icon" href="../../favicon.ico">
      <link rel="stylesheet" href="../../public/docfx.min.css">
      <link rel="stylesheet" href="../../public/main.css">
      <meta name="docfx:navrel" content="../../toc.html">
      <meta name="docfx:tocrel" content="../../x-cross/toc.html">
      
      <meta name="docfx:rel" content="../../">
      
      
      <meta name="docfx:docurl" content="https://github.com/nanoframework/nanoframework.github.io/blob/pages-source/content/getting-started-guides/troubleshooting-device-connection.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../index.html">
            <img id="logo" class="svg" src="../../logo.svg" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="troubleshooting-device-connection">Troubleshooting device connection</h1>

<p>Sometimes, you may have problem with a device. You may have hard time to find it, hard time to flash it and after flash you may not find it in the Visual Studio extension. So this article is for you and will give you elements to figure out the root cause.</p>
<p>This example will use an ESP32 device but it works in a similar way for other devices.</p>
<h2 id="assumptions">Assumptions</h2>
<p>We assume you have properly installed the .NET nanoFramework flash tool called <code>nanoff</code>. If not, go <a href="https://github.com/nanoframework/nanoFirmwareFlasher">here</a>.</p>
<p>We also assume you have properly installed the Visual Studio Extension. If not the case, then go <a href="getting-started-managed.html">here</a>.</p>
<p>And finally, we assume you have a tool to watch port serial traffic like <code>putty</code>. If you don't have any, go <a href="https://www.chiark.greenend.org.uk/%7Esgtatham/putty/latest.html">here</a>.</p>
<h2 id="finding-the-serial-port-of-your-device">Finding the serial port of your device</h2>
<p>The main trick here is to run 2 times the following command: <code>nanoff --listports</code></p>
<h3 id="finding-ports-on-windows">Finding ports on Windows</h3>
<p>The first time it will look like this on Windows:</p>
<p><img src="../../images/getting-started-guides/trb-listports.png" alt="list ports empty"></p>
<p>Then once you plug your device and rerun the command, you will see your port:</p>
<p><img src="../../images/getting-started-guides/trb-listports-found.png" alt="list ports found"></p>
<p>In this case, the com port is <code>COM3</code> on Windows. Bravo!</p>
<p>In case you don't see anything at all, then make sure you have the proper drive installed. If you don't have the proper driver installed, you'll get in the device explorer an error. If all is properly installed, you'll also be able to find the port:</p>
<p><img src="../../images/getting-started-guides/getting-started-find-com-port.gif" alt="Finding COM Port"></p>
<h3 id="finding-ports-on-linuxmacos">Finding ports on Linux/MacOS</h3>
<p>And like this on MacOS/Linux with no device plugged in:</p>
<p><img src="../../images/getting-started-guides/trb-listports-mac.png" alt="list ports empty"></p>
<p>Once you plug the device, you'l get the port details:</p>
<p><img src="../../images/getting-started-guides/trb-listports-found-mac.png" alt="list ports found"></p>
<p>We'll use the tty one, so <code>/dev/tty.usbserial-531F00209021</code>. The naming can be very different depending on the device you are using. In all the cases, make sure the latest drivers are installed.</p>
<p>In case you won't find your device, it's recommended to install <code>lsusb</code>. For linux, depending on the version, just use <code>apt-get install lsusb</code> and for MacOS <code>brew install lsusb</code> (you may have to use higher privileges using <code>sudo</code>).</p>
<p>Then similar to using the nanoff command, unplug your device and run <code>lsusb</code> to list the connected devices. Run it a second time with the device connected to figure out what it is and which drivers are required. The result will looks like this:</p>
<p><img src="../../images/getting-started-guides/trb-lsusb.png" alt="lsusb empty"></p>
<p>And with the added device:</p>
<p><img src="../../images/getting-started-guides/trb-lsusb-found.png" alt="lsusb empty"></p>
<p>You can refer to the hardware found and then to the vendor to find out what drivers are needed.</p>
<h2 id="my-device-flashes-but-i-cant-find-it-in-visual-studio-extension">My device flashes but I can't find it in Visual Studio extension</h2>
<p>You've flashed the device successfully using <code>nanoff</code> but you don't see it in the Visual Studio Extension.</p>
<p>First, check <a href="trouble-shooting-guide.html">this troubleshooting guide</a>!</p>
<p>Still nothing? OK, let's debug the device itself.</p>
<h3 id="special-esp32">Special ESP32</h3>
<p>ESP32 devices at boot time will output quite a lot of things. For this, you need to connect your deviceESP32 with the proper serial port (in the previous example <code>COM3</code> for Windows and <code>/dev/tty.usbserial-531F00209021</code> for Linux/Mac) with a baud rate of 115200.</p>
<p><img src="../../images/getting-started-guides/trb-config-putty.png" alt="putty config"></p>
<p>And when you connect <strong>and</strong> reset the device by pressing the little EN or BOOT or equivalent button of your ESP32, you'll get a result like this:</p>
<p><img src="../../images/getting-started-guides/trb-esp32-boot.png" alt="putty ESP32 outcome"></p>
<p>If your device is ok, you should see all green, no red lines. If you have red lines, it may be related to an issue, that can point you on something broken in your device. If the device reboots all the time, you'll get this screen over and over, it then means the device can be out of order or you have a problem with the image.</p>
<p>If at this point all is good for your device, go to the next step.</p>
<h3 id="finding-if-nanoframework-booted">Finding if nanoFramework booted</h3>
<p>To know if your device boots properly, use putty or equivalent and open the serial port your device is connected to with the baud rate of <code>921600</code>, this is the baud rate used by <code>Console.WriteLine</code> or <code>Debug.WriteLine</code> and whenever you have exceptions or equivalent raised by the CLR.</p>
<p><img src="../../images/getting-started-guides/trb-putty-921600.png" alt="putty config"></p>
<p>Regardless of your device, once you connect it, you will see the message <code>NFPKTV1</code> appearing. This means that .NET nanoFramework is properly loaded and working. To see it, you may have to reboot your device by pressing buttons like EN, RST, BOOT or equivalent.</p>
<p><img src="../../images/getting-started-guides/trb-nano-booted.png" alt="putty config"></p>
<p>Don't worry about the possible scramble characters before, they are the ones from the boot of the device itself. Some devices like ESP32 are quite chatty (see previous section), some devices like STM32 are very quite!</p>
<p>From that point, seeing this message means the device is properly working, so look again at <a href="trouble-shooting-guide.html">this troubleshooting guide</a>.</p>
<h3 id="devices-with-multiple-serial-ports">Devices with multiple serial ports</h3>
<p>Some devices like the ESP32 S3 may come with multiple serial ports. They usually have one named USB, the other one named UART. In those cases, one port is used to flash the device with nanoff and the other one to be seen by Visual Studio.</p>
<p>If you are not sure which port to use, plug one, try to flash on it, if it doesn't work, use the other one.</p>
<p>In most cases, you <strong>cannot</strong> connect both serial ports to your machine, as this interferes with the flash process and does not allow the device to go into boot mode.</p>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/nanoframework/nanoframework.github.io/blob/pages-source/content/getting-started-guides/troubleshooting-device-connection.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>

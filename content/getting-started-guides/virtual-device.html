<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
      <title>.NET nanoFramework Virtual Device | .NET nanoFramework Documentation </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content=".NET nanoFramework Virtual Device | .NET nanoFramework Documentation ">
      
      <link rel="icon" href="../../favicon.ico">
      <link rel="stylesheet" href="../../public/docfx.min.css">
      <link rel="stylesheet" href="../../public/main.css">
      <meta name="docfx:navrel" content="../../toc.html">
      <meta name="docfx:tocrel" content="../../x-cross/toc.html">
      
      <meta name="docfx:rel" content="../../">
      
      
      <meta name="docfx:docurl" content="https://github.com/nanoframework/nanoframework.github.io/blob/pages-source/content/getting-started-guides/virtual-device.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">
  </head>

  <script type="module" src="./../../public/docfx.min.js"></script>

  <script>
    const theme = localStorage.getItem('theme') || 'auto'
    document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
  </script>


  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../index.html">
            <img id="logo" class="svg" src="../../logo.svg" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled="" placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" style="margin-top: -.65em; margin-left: -.8em" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="net-nanoframework-virtual-device">.NET <strong>nanoFramework</strong> Virtual Device</h1>

<p>A .NET <strong>nanoFramework</strong> <em>Virtual Device</em> is available as a <a href="https://docs.microsoft.com/en-us/dotnet/core/tools/global-tools">.NET Tool</a>. It allows to run nanoCLR on Windows machines. This can be useful for development purposes, performing automated tests on pipelines and other usage scenarios that benefit from having a virtual device opposed to real physical hardware. The virtual device can be accessed just like a real one through a virtual serial port or a TCP/IP port.</p>
<p>The Visual Studio extension can interact with the .NET <strong>nanoFramework</strong> virtual device just like it does with a real device. It will be listed in Device Explorer window and will offer the same option as a real device.</p>
<p><img src="../../images/virtual-device/device-explorer-showing-virtual-device.png" alt="virtual device listed in device explorer"></p>
<blockquote>
<p>Note: the .NET Tool with the <strong>nanoFramework</strong> virtual device is not exclusive of the Visual Studio extension. It's a global tool that can be use standalone. Read below instructions on how to use it.</p>
</blockquote>
<p>The serial port that exposes the <strong>nanoFramework</strong> virtual device is provided by <a href="https://www.hhdsoftware.com/">HHD Software</a> which has kindly sponsored a free license for running their tool in .NET <strong>nanoFramework</strong> tools.</p>
<h2 id="configuring-the-virtual-device">Configuring the Virtual Device</h2>
<p>To enable and configure .NET <strong>nanoFramework</strong> virtual device, open the <code>Settings</code> configuration dialog in Device Explorer (click on the cog wheel icon in the toolbar). Navigate to the <code>Virtual Device</code> tab.</p>
<p><img src="../../images/virtual-device/settings-virtual-device-tab.png" alt="virtual device configurations"></p>
<p>To enable the Virtual Device, simply check the &quot;Enable Virtual Device&quot; check box. This will start <strong>nanoFramework</strong> virtual device with Visual Studio. If the tool is not installed, Visual Studio will do it in the background. If the Virtual Device is not needed, uncheck the option and it won't be started.</p>
<p>A specific serial port can be configured to expose the Virtual Device. Enter a valid COM port name in the <code>Serial Port</code> text box and this will be used. If the virtual serial port doesn't exist yet, it will be created.</p>
<p>The virtual device can be started &amp; stopped by clicking the respective button.</p>
<p>Last configuration pertains the automatic update of the nanoCLR image that the virtual device will be running. To have the tool automatically update and use the latest available version, just enable the checkbox.</p>
<blockquote>
<p>Note: if a specific nanoCLR version was installed, the virtual device will use that one. This is useful if you're testing a specific version of a library of firmware version, for example.</p>
</blockquote>
<h2 id="output-from-virtual-device">Output from Virtual Device</h2>
<p>The output from the virtual device is made available in Visual Studio Output pane, just select <code>.NET nanoFramework Virtual Device</code>.</p>
<p><img src="../../images/virtual-device/settings-virtual-device-tab.png" alt="virtual device configurations"></p>
<h2 id="known-limitations">Known limitations</h2>
<p>The virtual device has implemented most of the libraries and APIs that do not require hardware interaction. For those a &quot;stubbed&quot; version is offered meaning that a call to those APIs will result on a <code>Not Implemented Exception</code>. There is also no support for network. This will be added in a future version.</p>
<h2 id="usage">Usage</h2>
<p>Once the tool is installed, you can call it by using its command <code>nanoclr</code>, which is a short version of the name to ease typing.</p>
<pre><code class="lang-console">nanoclr [command] [args]
</code></pre>
<p>The tool includes help for all available commands. You can see a list of all available ones by entering:</p>
<pre><code class="lang-console">nanoclr --help
</code></pre>
<h2 id="virtual-serial-ports">Virtual Serial Ports</h2>
<p>This verb allows managing the virtual serial port exposing the virtual device.
The virtual serial port is only available in Windows machines. It's made available with the sponsorship of <a href="https://www.hhdsoftware.com/">HHD Software</a> which has kindly sponsored a free license for running their tool.</p>
<h3 id="list-virtual-serial-ports">List Virtual Serial ports</h3>
<p>This command lists the installed virtual serial port bridges in the system.</p>
<pre><code class="lang-console">nanoclr virtualserial --list
</code></pre>
<h3 id="create-virtual-serial-port">Create Virtual Serial port</h3>
<p>This command creates a virtual serial port that will be used to expose the nanoCLR instance. A random COM port will be created.
A COM port can be optionally specified as an option. In this case, if that COM port it's not being used, it will be created.</p>
<pre><code class="lang-console">nanoclr virtualserial --create [COM99]
</code></pre>
<h3 id="remove-virtual-serial-port">Remove Virtual Serial port</h3>
<p>This command removes an existing virtual serial port.</p>
<pre><code class="lang-console">nanoclr virtualserial --remove [COM99]
</code></pre>
<h3 id="install-virtual-serial-port-tools">Install Virtual Serial Port tools</h3>
<p>This command installs <a href="https://www.hhdsoftware.com/">HHD Software</a> Virtual Serial Port Tools software. The installer is downloaded from their website and executed. Executing the installer requires &quot;Install Driver&quot; privilege and must be elevated. If the process running it doesn't have the required permissions an UAC prompt will be show.</p>
<pre><code class="lang-console">nanoclr virtualserial --install
</code></pre>
<h2 id="running-the-virtual-nanoclr">Running the virtual nanoCLR</h2>
<p>These options run the nanoCRL instance loading the specified assemblies and exposing the device on a specified interface. Please note that for successfully running a nanoCLR instance it's require to load a set of assemblies <em>and</em> specify an interface to expose it, otherwise it has no use.</p>
<h3 id="load-a-set-of-assemblies">Load a set of assemblies</h3>
<p>This loads a set of .NET nanoFramework assemblies and runs the nanoCLR. These have to be in .NET nanoFramework PE (Portable Executable) format.
They are found in the output folder of a Visual Studio project (typically <code>bin\Debug</code> or <code>bin\Release</code>). Full path of the PE files is required.</p>
<pre><code class="lang-console">nanoclr run --assemblies &quot;C:\nano\my_nice_project\bin\Debug\mscorlib.pe&quot; &quot;C:\nano\my_nice_project\bin\Debug\my_nice_project.pe&quot;
</code></pre>
<h3 id="specify-serial-port">Specify Serial Port</h3>
<p>This option specifies the COM port that will be used to expose the virtual nanoCLR that will be running. It requires a previous setup of a Virtual Serial Port (see <a href="#create-virtual-serial-port">Create Virtual Serial port</a>).</p>
<pre><code class="lang-console">nanoclr run --serialport COM99 (--assemblies ...)
</code></pre>
<h3 id="specify-named-pipe">Specify Named Pipe</h3>
<p>This option specifies a <a href="https://learn.microsoft.com/en-us/windows/win32/ipc/named-pipes">Named Pipe</a> that will be used to expose the virtual nanoCLR that will be running.</p>
<pre><code class="lang-console">nanoclr run --namedpipe MyNanoDevice (--assemblies ...)
</code></pre>
<h3 id="resolve-references">Resolve references</h3>
<p>This option tries to resolve cross-assembly references between the loaded assemblies.</p>
<pre><code class="lang-console">nanoclr run --resolve (--assemblies ...)
</code></pre>
<h2 id="maintenance-operations-with-the-nanoclr">Maintenance operations with the nanoCLR</h2>
<p>The nanoCLR is, in fact, a wrapper to the nanoCLR instance that is distributed as DLL so it can be easily updated.
The following operations are available to manage this.</p>
<h3 id="version-of-nanoclr">Version of nanoCLR</h3>
<p>Gets the version of the current nanoCLR instance.</p>
<pre><code class="lang-console">nanoclr instance --getversion
</code></pre>
<h3 id="update-nanoclr-instance">Update nanoCLR instance</h3>
<p>Checks for stable versions of nanoCLR and updates it, if there is one. A version can be specified. To check preview versions add the <code>--preview</code> option.</p>
<pre><code class="lang-console">nanoclr instance --update [--preview] [--clrversion 1.22.333.4444]
</code></pre>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/nanoframework/nanoframework.github.io/blob/pages-source/content/getting-started-guides/virtual-device.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>

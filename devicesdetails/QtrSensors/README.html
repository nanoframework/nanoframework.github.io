<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>QTR Sensors - Pololu QTR Reflectance Sensors | .NET nanoFramework Documentation </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="QTR Sensors - Pololu QTR Reflectance Sensors | .NET nanoFramework Documentation ">
    <meta name="generator" content="docfx 2.59.4.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../../x-cross/toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="qtr-sensors---pololu-qtr-reflectance-sensors">QTR Sensors - Pololu QTR Reflectance Sensors</h1>

<p>Those sensors are popular on small robots to have scenarios like line following. They provide a way to calibrate, read, and provide high level functions to help in line following.</p>
<p>While this implementation has been tested with reflectance sensors, this will work with any type of analogic sensor. The original design have the sensors lining up but the shape of the sensors can be anything. Just keep in mind that the ReadPosition function will not be relevant if you don't have the sensors aligned.</p>
<h2 id="documentation">Documentation</h2>
<p>Official documentation can be fond <a href="https://www.pololu.com/category/123/pololu-qtr-reflectance-sensors">here</a>.</p>
<h2 id="qtr-sensors">QTR Sensors</h2>
<p>You will find different implementation of those. All implementations from Pololu have aligned sensors. Some others may have different implementation. The present implementation is only for analogic sensors. It will not only work with Pololu sensors but with any analogic sensors. They have to have 1 or 2 common emitters.</p>
<h2 id="usage">Usage</h2>
<p>You can create q QtrAnalog sensor with an array of GPIO for the individual sensors and an array of 0 or 1 or 2 GPIO for the emitter.</p>
<pre><code class="lang-csharp">// In this case, we will use 1 emitter and 5 sensors
QtrAnalogic qtr = new(new int[] { 33, 14, 26, 4, 13 }, new int[] { 15 });
</code></pre>
<h3 id="calibration">Calibration</h3>
<p>It is recommended to calibrate the sensors on the surface you are going to use without any line or perturbation. This will increase the accuracy of the line detection if you're using this scenario.</p>
<pre><code class="lang-csharp">var calibOn = qtr.Calibrate(10, true);
var calibOff = qtr.Calibrate(10, false);
</code></pre>
<h3 id="samples-per-sensor-emitters-and-emitter-values">Samples per sensor, emitters and emitter values</h3>
<p>You can adjust the number or reads you'll do per sensor. The read value will be averaged. Keep in mind that reading the sensor is taking time, so the more you read, the more time it takes. If you are using a robot scenario, try to limit the sapling if it is moving fast.</p>
<pre><code class="lang-csharp">// This will read each sensor 5 times
qtr.SamplesPerSensor = 5;
</code></pre>
<p>You can as well adjust the sensor emitter pins to either on or off and choose to have all of them, none, even or odds one. The combination will allow you to find a flexible way depending on your scenario. And you can as well do not create the QTR Sensors with emitter pins and manage them yourself.</p>
<pre><code class="lang-csharp">qtr.EmitterSelection = EmitterSelection.All;
qtr.EmitterValue = PinValue.High;
</code></pre>
<p>Note this has impact on the measurement. The calibration can be preformed for the 2 scenarios: with the emitter on and off.</p>
<h3 id="read-raw-values">Read raw values</h3>
<p>You can get the raw values without calibration by using the <code>ReadRaw</code> function. This will give the values as they are without using any calibration.</p>
<pre><code class="lang-csharp">// Raws is an array of double
var raws = qtr.ReadRaw();
</code></pre>
<h3 id="read-ratio-value">Read ratio value</h3>
<p>You can get normalized reading of the data using the calibration if you've done it. The results will be between 0 and 1.0</p>
<pre><code class="lang-csharp">var ratios = qtr.ReadRatio();
</code></pre>
<h3 id="read-position-values">Read position values</h3>
<p>This is useful in line following scenarios. You can get a position between -1.0 and +1.0 where 0.0 is the middle, meaning it has detected in the middle of the sensors.</p>
<pre><code class="lang-csharp">// By default it will read black/dark lines out of a white/clear background
var pos = qtr.ReadPosition();
</code></pre>
<p>Note: the sensor will keep the last position, so if you were close to -1 and the line is not detected, it will continue to give you -1. Same for +1. Arbitrary, -1 is used for the first GPIO number you gave in the constructor and +1 for the last one.</p>
<p>This is using normalized and pondered data to provide this value.</p>
<pre><code class="lang-csharp">// This will read the position of a white/clear line on a black/dark background
var pos = qtr.ReadPosition(false);
</code></pre>
<h2 id="current-implementation">Current implementation</h2>
<p>QTR Sensors type:</p>
<ul>
<li>[x] Analog QTR sensors</li>
<li>[ ] Digital QTR sensors</li>
</ul>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/nanoframework/nanoframework.github.io/blob/pages-source/devicesdetails/QtrSensors/README.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Copyright © 2018 nanoFramework Contributors<br>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>

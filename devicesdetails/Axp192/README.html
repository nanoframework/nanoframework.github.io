<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>

  <head>
    <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <title>AXP192 - Enhanced single Cell Li-Battery and Power System Management IC | .NET nanoFramework Documentation </title>
      <meta name="viewport" content="width=device-width">
      <meta name="title" content="AXP192 - Enhanced single Cell Li-Battery and Power System Management IC | .NET nanoFramework Documentation ">
    

      <link rel="apple-touch-icon" sizes="180x180" href="../../favicons/apple-touch-icon.png">
      <link rel="icon" type="image/png" sizes="32x32" href="../../favicons/favicon-32x32.png">
      <link rel="icon" type="image/png" sizes="16x16" href="../../favicons/favicon-16x16.png">
      <link rel="icon" type="image/svg+xml" href="../../favicons/favicon.svg">
      <link rel="icon" type="image/png" href="../../favicons/favicon.png">
      <link rel="manifest" href="../../favicons/site.webmanifest">
      <link rel="shortcut icon" type="image/x-icon" href="../../favicons/favicon.ico">
      <link rel="mask-icon" href="../../favicons/safari-pinned-tab.svg" color="#222222">
      <meta name="msapplication-config" content="../../favicons/browserconfig.xml">
      <meta name="msapplication-TileColor" content="#222222">
      <meta name="theme-color" content="#222222">

      <link rel="stylesheet" href="../../styles/docfx.vendor.min.css">
      <link rel="stylesheet" href="../../styles/docfx.css">
      <link rel="stylesheet" href="../../styles/main.css">
      <meta property="docfx:navrel" content="../../toc.html">
      <meta property="docfx:tocrel" content="../../x-cross/toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>

        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">

        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">

        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="axp192---enhanced-single-cell-li-battery-and-power-system-management-ic">AXP192 - Enhanced single Cell Li-Battery and Power System Management IC</h1>

<h2 id="documentation">Documentation</h2>
<p>-Product documentation can be found <a href="https://m5stack.oss-cn-shenzhen.aliyuncs.com/resource/docs/datasheet/core/AXP192_datasheet_en.pdf">here</a>.
-Registers can be found <a href="https://m5stack.oss-cn-shenzhen.aliyuncs.com/resource/docs/datasheet/core/AXP192_datasheet_cn.pdf">here</a> (Chineese only, note: bing translator make miracle).</p>
<ul>
<li>This sensor is used in the <a href="https://docs.m5stack.com/en/core/m5stickc">M5Stick</a>. Initialization code for this device can be found <a href="https://github.com/m5stack/M5StickC/blob/master/src/AXP192.cpp">here</a>.</li>
</ul>
<h2 id="usage">Usage</h2>
<pre><code class="lang-csharp">// Make sure you configure properly the I2C pins, here example for ESP32
Configuration.SetPinFunction(22, DeviceFunction.I2C1_CLOCK);
Configuration.SetPinFunction(21, DeviceFunction.I2C1_DATA);

I2cDevice i2cAxp192 = new(new I2cConnectionSettings(1, Axp192.I2cDefaultAddress));
Axp192 power = new Axp192(i2cAxp192);
</code></pre>
<blockquote>
<p><strong>Important</strong>: make sure you read th documentation of your battery and setup the proper charging values, stop current. Overcharging your battery may damage it.</p>
</blockquote>
<h3 id="using-the-button">Using the button</h3>
<p>One button is available and can be setup to track short and long press:</p>
<pre><code class="lang-csharp">// This part of the code will handle the button behavior
power.EnableButtonPressed(ButtonPressed.LongPressed | ButtonPressed.ShortPressed);
power.SetButtonBehavior(LongPressTiming.S2, ShortPressTiming.Ms128, true, SignalDelayAfterPowerUp.Ms32, ShutdownTiming.S10);
</code></pre>
<p>The status is kept in the registers up to the next status read. You can then have both a short and a long press, you can get the status like this:</p>
<pre><code class="lang-csharp">var status = power.GetButtonStatus();
if ((status &amp; ButtonPressed.ShortPressed) == ButtonPressed.ShortPressed)
{
    Debug.WriteLine(&quot;Short press&quot;);
}
else if ((status &amp; ButtonPressed.LongPressed) == ButtonPressed.LongPressed)
{
    Debug.WriteLine(&quot;Long press&quot;);
}
</code></pre>
<h3 id="battery-status">Battery status</h3>
<p>You can get various elements regarding the battery status:</p>
<pre><code class="lang-csharp">Debug.WriteLine($&quot;Battery:&quot;);
Debug.WriteLine($&quot;  Charge curr  : {power.GetBatteryChargeCurrent().Milliamperes} mA&quot;);
Debug.WriteLine($&quot;  Status       : {power.GetBatteryChargingStatus()}&quot;);
Debug.WriteLine($&quot;  Dicharge curr: {power.GetBatteryDischargeCurrent().Milliamperes} mA&quot;);
Debug.WriteLine($&quot;  Inst Power   : {power.GetBatteryInstantaneousPower().Milliwatts} mW&quot;);
Debug.WriteLine($&quot;  Voltage      : {power.GetBatteryVoltage().Volts} V&quot;);
Debug.WriteLine($&quot;  Is battery   : {power.IsBatteryConnected()} &quot;);
</code></pre>
<h3 id="advanced-features">Advanced features</h3>
<p>The AXP192 can charge the battery, get and set charging current, cut off voltage, has protection for temperature. Most feature can be access or setup. You can check out the <a href="./samples">sample</a> to get more details on how to set those advance features.</p>
<blockquote>
<p>Note: this binding uses UnitsNet for the units like Voltage, Amperes.</p>
</blockquote>
<p>Here is an example reading the current, voltage:</p>
<pre><code class="lang-csharp">Debug.WriteLine($&quot;Temperature : {power.GetInternalTemperature().DegreesCelsius} °C&quot;);
Debug.WriteLine($&quot;Input:&quot;);
// Note: the current and voltage will show 0 when plugged into USB.
// To see something else than 0, you should output those data on a serial port for example
// Or display on the screen.
Debug.WriteLine($&quot;  Current   : {power.GetInputCurrent().Milliamperes} mA&quot;);
Debug.WriteLine($&quot;  Voltage   : {power.GetInputVoltage().Volts} V&quot;);
Debug.WriteLine($&quot;  Status    : {power.GetInputPowerStatus()}&quot;);
Debug.WriteLine($&quot;  USB volt  : {power.GetUsbVoltageInput().Volts} V&quot;);
Debug.WriteLine($&quot;  USB Curr  : {power.GetUsbCurrentInput().Milliamperes} mA&quot;);
</code></pre>
<h3 id="coulomb-counter">Coulomb counter</h3>
<p>The AXP192 has a Coulomb counter where the value is in mili Amperes per hour (this one is not yet using UnitsNet). You first have to enable the Counter and then you can read the value. It is recommended to let some time between the moment you enable and read the data. Features to reset, stop the count are available as well</p>
<pre><code class="lang-csharp">power.EnableCoulombCounter();
// Do something here
// You can then read periodically the Coulomb counter:
Debug.WriteLine($&quot;Coulomb: {power.GetCoulomb()} mA/h&quot;);
</code></pre>
</article>
          </div>

          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/nanoframework/nanoframework.github.io/blob/pages-source/devicesdetails/Axp192/README.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      
      <span>Copyright © 2023 nanoFramework Contributors<br>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>    </div>

    <script type="text/javascript" src="../../styles/docfx.vendor.min.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
      <title>Mcp23xxx/MCP23008/MCP23009/MCP23017/MCP23018 - I/O Expander device family | .NET nanoFramework Documentation </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Mcp23xxx/MCP23008/MCP23009/MCP23017/MCP23018 - I/O Expander device family | .NET nanoFramework Documentation ">
      
      
      <link rel="icon" href="../../favicon.ico">
      <link rel="stylesheet" href="../../public/docfx.min.css">
      <link rel="stylesheet" href="../../public/main.css">
      <meta name="docfx:navrel" content="../../toc.html">
      <meta name="docfx:tocrel" content="../../x-cross/toc.html">
      
      <meta name="docfx:rel" content="../../">
      
      
      <meta name="docfx:docurl" content="https://github.com/nanoframework/nanoframework.IoT.Device/blob/develop/devices/Mcp23xxx/README.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">
  </head>

  <script type="module" src="./../../public/docfx.min.js"></script>

  <script>
    const theme = localStorage.getItem('theme') || 'auto'
    document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
  </script>


  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../index.html">
            <img id="logo" class="svg" src="../../logo.svg" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled="" placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" style="margin-top: -.65em; margin-left: -.8em" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="mcp23xxxmcp23008mcp23009mcp23017mcp23018---io-expander-device-family">Mcp23xxx/MCP23008/MCP23009/MCP23017/MCP23018 - I/O Expander device family</h1>

<p>The MCP23XXX device family provides 8/16-bit, general purpose parallel I/O expansion for I2C or SPI applications.  These devices include a range of addressing schemes and I/O configurations including pull-up resistors, polarity inverting, and interrupts.</p>
<blockquote>
<p>Note: this port was started from .NET IoT to .NET nanoframework. Currently only I2C devices are supported.</p>
</blockquote>
<h2 id="documentation">Documentation</h2>
<ul>
<li>The documentation from <a href="https://www.adafruit.com/product/732">Adafruit</a></li>
<li><a href="https://learn.adafruit.com/using-mcp23008-mcp23017-with-circuitpython/overview">Learn how to use MCP23008 and MCP23017 with Python</a> from the Adafruit learn courses used to create this binding.</li>
</ul>
<h3 id="device-family">Device Family</h3>
<p>MCP23XXX devices contain different markings to distinguish features like interfacing, packaging, and temperature ratings.  For example, MCP23017 contains an I2C interface and MCP23S17 contains a SPI interface.  Please review specific datasheet for more information.</p>
<ul>
<li>MCP23X08 <a href="http://ww1.microchip.com/downloads/en/DeviceDoc/21919e.pdf">datasheet</a></li>
<li>MCP23X09 <a href="http://ww1.microchip.com/downloads/en/DeviceDoc/20002121C.pdf">datasheet</a></li>
<li>MCP23X17 <a href="http://ww1.microchip.com/downloads/en/DeviceDoc/20001952C.pdf">datasheet</a></li>
<li>MCP23X18 <a href="http://ww1.microchip.com/downloads/en/DeviceDoc/22103a.pdf">datasheet</a></li>
</ul>
<p><strong>NOTE</strong>: MCP23X16 contains different internal circuitry and is not compatible with this binding.</p>
<h2 id="usage">Usage</h2>
<h3 id="mcp230xx-i2c">Mcp230xx I2C</h3>
<pre><code class="lang-csharp">// 0x20 is the device address in this example.
var connectionSettings = new I2cConnectionSettings(1, 0x20);
var i2cDevice = I2cDevice.Create(connectionSettings);
var mcp23S17 = new Mcp23017(i2cDevice);
</code></pre>
<h3 id="mcp23sxx-spi">Mcp23Sxx SPI</h3>
<pre><code class="lang-csharp">var connectionSettings = new SpiConnectionSettings(0, 0)
{
    ClockFrequency = 1000000,
    Mode = SpiMode.Mode0
};

var spiDevice = SpiDevice.Create(connectionSettings);

// 0x20 is the device address in this example.
var mcp23S17 = new Mcp23S17(spiDevice, 0x20);
</code></pre>
<h3 id="register-banking-and-ports">Register Banking and Ports</h3>
<p>On 16-bit expanders the GPIO ports are grouped into 2 &quot;ports&quot;. Via the <code>IGpioController</code> interface we expose the pins logically as 0-15, with the first bank being 0-7 and the second being 8-15.</p>
<p>When using <code>ReadByte()</code> or <code>WriteByte()</code> on the 16-bit chips you can specify <code>PortA</code> or <code>PortB</code> to write to respective registers. The default is <code>PortA</code>. Reading and writing <code>ushort</code> writes to both ports.</p>
<p>The internal circuitry has a banking concept to group by port registers or by register type.  This enables different configurations for reading/writing schemes. While we have some support for the bank styles it is not exposed directly. There is no safe way to detect the mode and most other drivers do not support anything but the defaults. You need to derive from <code>Mcp23xxx</code> directly.</p>
<h4 id="example-for-16-bit-device">Example for 16-bit device</h4>
<pre><code class="lang-csharp">// Read Port B's Input Polarity Port Register (IPOL).
byte data = mcp23S17.Read(Register.IPOL, Port.PortB);
</code></pre>
<h4 id="example-for-8-bit-device">Example for 8-bit device</h4>
<p>The MCP23X08 only contains 1 port so there is not a choice for port when addressing the register.</p>
<pre><code class="lang-csharp">// Read port A's GPIO Pull-Up Resistor Register (GPPU).
byte data = mcp23S08.ReadByte(Register.GPPU);
</code></pre>
<h3 id="controller-pins">Controller Pins</h3>
<p>The <code>Mcp23xxx</code> has overloaded pin options when instantiating the device.  This includes a reset line, which is an output pin of the controller to the MCP23XXX RST input pin.  The other pins are interrupt options, which are inputs to the controller from the MCP23XXX INTA/INTB output pins.  They are optional arguments.  Assign as <code>null</code> for the pins you don't use.</p>
<pre><code class="lang-csharp">// Pin 10: Reset; Output to Mcp23xxx
// Pin 25: INTA;  Input from Mcp23xxx
// Pin 17: INTB;  Input from Mcp23xxx
var mcp23S17 = new Mcp23S17(spiDevice, 0x20, 10, 25, 17);
</code></pre>
<p>The MCP23XXX will be in the reset/disabled state by default if you use the reset pin.  You must call the <code>Enable()</code> method to activate the device.</p>
<pre><code class="lang-csharp">var mcp23S17 = new Mcp23S17(spiDevice, 0x20, 10, 25, 17);
mcp23S17.Enable();
// Can now communicate with device.

// Turn off again if needed.
mcp23S17.Disable();
</code></pre>
<p><strong>TODO</strong>: Interrupt pins can only be read for now.  Events are coming in a future PR.</p>
<pre><code class="lang-csharp">var mcp23S17 = new Mcp23S17(spiDevice, 0x20, 10, 25, 17);
PinValue interruptA = mcp23S17.ReadInterruptA();
PinValue interruptB = mcp23S17.ReadInterruptB();
</code></pre>
<h2 id="binding-notes">Binding Notes</h2>
<p>This binding includes an <code>Mcp23xxx</code> abstract class and derived abstract classes for 8-bit <code>Mcp23x0x</code> and 16-bit <code>Mcp23x1x</code> variants.</p>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/nanoframework/nanoframework.IoT.Device/blob/develop/devices/Mcp23xxx/README.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>


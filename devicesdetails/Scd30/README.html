<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Sensirion SCD30 Particulate Matter Sensor | .NET nanoFramework Documentation </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Sensirion SCD30 Particulate Matter Sensor | .NET nanoFramework Documentation ">
      
      <link rel="icon" href="../../favicon.ico">
      <link rel="stylesheet" href="../../public/docfx.min.css">
      <link rel="stylesheet" href="../../public/main.css">
      <meta name="docfx:navrel" content="../../toc.html">
      <meta name="docfx:tocrel" content="../../x-cross/toc.html">
      
      <meta name="docfx:rel" content="../../">
      
      
      <meta name="docfx:docurl" content="https://github.com/nanoframework/nanoframework.IoT.Device/blob/develop/devices/Scd30/README.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">
  </head>

  <script type="module" src="./../../public/docfx.min.js"></script>

  <script>
    const theme = localStorage.getItem('theme') || 'auto'
    document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
  </script>


  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../index.html">
            <img id="logo" class="svg" src="../../logo.svg" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled="" placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" style="margin-top: -.65em; margin-left: -.8em" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="sensirion-scd30-particulate-matter-sensor">Sensirion SCD30 Particulate Matter Sensor</h1>

<p>This is a library to interact with the Sensirion SCD30 Sensor Module for CO2, humidity and temperature. Currently, only the Modbus interface is implemented. The SCD30 also supports I2C, but requires clock stretching, which is currently not supported in the .NET Nanoframework ESP32 implementation.</p>
<p><img src="../../devicesimages/Scd30/Scd30-image.png" alt="Scd30-image.png"></p>
<h2 id="documentation">Documentation</h2>
<ul>
<li>For this implementation the official <a href="https://sensirion.com/media/documents/4EAF6AF8/61652C3C/Sensirion_CO2_Sensors_SCD30_Datasheet.pdf">datasheet</a> and <a href="https://sensirion.com/media/documents/D7CEEF4A/6165372F/Sensirion_CO2_Sensors_SCD30_Interface_Description.pdf">interface description</a> have been used.</li>
</ul>
<h2 id="usage-for-the-modbus-interface">Usage for the Modbus interface</h2>
<p><strong>Important</strong>: make sure you properly setup the UART pins for ESP32 before creating the <code>SerialPort</code>. For this, make sure you install the <code>nanoFramework.Hardware.Esp32</code> NuGet and use the <code>Configuration</code> class to configure the pins:</p>
<pre><code class="lang-csharp">Configuration.SetPinFunction(5, DeviceFunction.COM3_TX);
Configuration.SetPinFunction(27, DeviceFunction.COM3_RX);
</code></pre>
<p>Initialize the <code>SerialPort</code> and pass it to the <code>Scd30Sensor</code>. You'll stay in control of the <code>SerialPort</code> for any exotic situations (i.e. <code>InvertSignalLevels</code> or multiplexing scenarios). The constructor of the <code>Scd30Sensor</code> will configure the <code>SerialPort</code> to the expected <code>BaudRate</code> and other settings:</p>
<pre><code class="lang-csharp">var scd30 = new Scd30Sensor(new SerialPort(&quot;COM3&quot;));
</code></pre>
<p>Use the <code>scd30</code> to interact with the sensor, e.g.:</p>
<pre><code class="lang-csharp">var firmware = scd30.ReadFirmwareVersion();
Debug.WriteLine($&quot;SCD30 detected: Firmware version={firmware}&quot;);
</code></pre>
<p>Collect a measurement reliably:</p>
<pre><code class="lang-csharp">scd30.SetMeasurementInterval(TimeSpan.FromSeconds(2));
scd30.StartContinuousMeasurement();
Thread.Sleep(5000);
if (scd30.GetDataReadyStatus())
{
    var measurement = scd30.ReadMeasurement();
    Debug.WriteLine($&quot;Measurement: {measurement}&quot;);
}
</code></pre>
<p>The above would output the following:</p>
<pre><code class="lang-text">SCD30 detected: Firmware version=3.66
Measurement: Co2Concentration=400.8741 ppm, Temperature=27.10421752 °C, RelativeHumidity=32.75756835 %RH
</code></pre>
<p>Check out the sample for more information.</p>
<h2 id="i-dont-get-any-measurements-and-getdatareadystatus-never-returns-true">I don't get any measurements and <code>GetDataReadyStatus</code> never returns true!</h2>
<p>When this happens, make sure you provide enough current/voltage to your sensor. In my particular case I was providing power from the 3v3 of my Pycom WiPy to both the <code>vin</code> and <code>sel</code> pins
on the SCD30. However, the measurements never worked.</p>
<p>Instead, connecting the 5v to the <code>vin</code> and the 3v3 to <code>sel</code> made the SCD30 work as expected. The <code>sel</code> must be pulled high to enable the Modbus interface.</p>
<p><strong>DO NOT CONNECT 5V TO <code>sel</code>, it is only tolerant up to 4v so you must use a voltage divider if you do not have 3v3 available</strong></p>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/nanoframework/nanoframework.IoT.Device/blob/develop/devices/Scd30/README.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>


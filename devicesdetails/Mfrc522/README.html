<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
      <title>MFRC522 - RFID reader | .NET nanoFramework Documentation </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="MFRC522 - RFID reader | .NET nanoFramework Documentation ">
      
      
      <link rel="icon" href="../../favicon.ico">
      <link rel="stylesheet" href="../../public/docfx.min.css">
      <link rel="stylesheet" href="../../public/main.css">
      <meta name="docfx:navrel" content="../../toc.html">
      <meta name="docfx:tocrel" content="../../x-cross/toc.html">
      
      <meta name="docfx:rel" content="../../">
      
      
      <meta name="docfx:docurl" content="https://github.com/nanoframework/nanoframework.IoT.Device/blob/develop/devices/Mfrc522/README.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../index.html">
            <img id="logo" class="svg" src="../../logo.svg" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="mfrc522---rfid-reader">MFRC522 - RFID reader</h1>

<p>MFRC522 is a very cheap RFID/NFC reader for Iso 14443 Type A cards. Part of those cars are the <a href="https://github.com/nanoFramework/nanoFramework.IoT.Device/tree/develop/devices/Card/Mifare">Mifare</a> and <a href="../Card/Ultralight">Ultralight</a> family. This reader implement the proprietary Mifare cryptography protocol and can be used transparently.</p>
<h2 id="documentation">Documentation</h2>
<ul>
<li>MFRC5222 <a href="https://www.nxp.com/docs/en/data-sheet/MFRC522.pdf">Datasheet</a></li>
</ul>
<h2 id="usage">Usage</h2>
<p>MFRC522 supports SPI, I2C and UART (Serial Port). You can create the reader with any of those protocols.</p>
<p><strong>Note</strong>: most of the popular boards you'll buy are SPI only. This documentation will focus on SPI. You have in the <a href="https://github.com/nanoFramework/nanoFramework.IoT.Device/tree/develop/devices/Mfrc522/samples">samples</a> more information on how to setup I2C and UART.</p>
<pre><code class="lang-csharp">GpioController gpioController = new GpioController();
// adjust the GPIO used for the hard reset
int pinReset = 21;

// Default on ESP32:
// GPIO23 = MOSI; GPIO25 = MISO; GPIO19 = Clock

// Uncomment for SPI
SpiConnectionSettings connection = new(1, 22);
// Here you can use as well MfRc522.MaximumSpiClockFrequency which is 10_000_000
// Anything lower will work as well
connection.ClockFrequency = 5_000_000;
SpiDevice spi = SpiDevice.Create(connection);
MfRc522 mfrc522 = new(spi, pinReset, gpioController, false);
</code></pre>
<p>The code will create an instance of MFRC522 and will use the pin GPIO21 as the hardware rest pin and will create an GpioController automatically from the default driver. Check the detailed [samples] for more elements. More detailed examples shows how to use other type or cards.</p>
<p>You can get the version using the <code>Version</code> property.</p>
<pre><code class="lang-csharp">Debug.WriteLine($&quot;Version: {mfrc522.Version}, version should be 1 or 2. Some clones may appear with version 0&quot;);
</code></pre>
<p>Keep in mind that having a version which is 0.0 doesn't necessary means that your reader is not working properly, if you bought a cheap copy of an original MFRC522, the internal version may not be recognized.</p>
<p>MFRC522 only supports ISO 14443 Type A. You can pull a card like this:</p>
<pre><code class="lang-csharp">bool res;
Data106kbpsTypeA card;
do
{
    res = mfrc522.ListenToCardIso14443TypeA(out card, TimeSpan.FromSeconds(2));
    Thread.Sleep(res ? 0 : 200);
}
while (!res);
</code></pre>
<p>As soon as a card will be detected, it will get out a <code>Data106kbpsTypeA</code> class which is a card. You will have the Unique Identifier from the card as well as the rest of the elements to help identifying it.</p>
<p>You can then create a Mifare card and fo operation on it:</p>
<pre><code class="lang-csharp">var mifare = new MifareCard(mfrc522, 0);
mifare.SerialNumber = card.NfcId;
mifare.Capacity = MifareCardCapacity.Mifare1K;
mifare.KeyA = MifareCard.DefaultKeyA;
mifare.KeyB = MifareCard.DefaultKeyB;

mifare.BlockNumber = 0;
mifare.Command = MifareCardCommand.AuthenticationB;
ret = mifare.RunMifareCardCommand();
if (ret &lt; 0)
{
    mifare.ReselectCard();
    Debug.WriteLine($&quot;Error reading bloc: {mifare.BlockNumber}&quot;);
}
else
{
    mifare.Command = MifareCardCommand.Read16Bytes;
    ret = mifare.RunMifareCardCommand();
    if (ret &gt;= 0)
    {
        if (mifare.Data is object)
        {
            Debug.WriteLine($&quot;Bloc: {mifare.BlockNumber}, Data: {BitConverter.ToString(mifare.Data)}&quot;);
        }
    }
    else
    {
        mifare.ReselectCard();
        Debug.WriteLine($&quot;Error reading bloc: {mifare.BlockNumber}&quot;);
    }
}
</code></pre>
<p><strong>Important</strong>: you have to do the <code>ReselectCard()</code> operation every time you have a failure in reading or authentication. By default the card will stop responding. This behavior is wanted by design to make is longer to brute force the authentication mechanism. The <a href="https://github.com/nanoFramework/nanoFramework.IoT.Device/tree/develop/devices/Mfrc522/samples">samples</a> shows a way how to find a key from known keys for <a href="../Card/Ndef">NDEF</a> scenarios for example. Note that the sample is not fully optimize, it is to help understanding what as the mechanism behind.</p>
<h2 id="other-notes">Other notes</h2>
<ul>
<li>The SPI implementation has been deeply tested.</li>
<li>The I2C and UART has been barely tested due to lack of hardware support. So please open issues if you have any issue.</li>
<li>When using I2C, the address can be setup using the hardware pin, it's the reason why there is no default address.</li>
<li>If you are using UART, it is more than strongly recommended to use as high as possible serial baud transfer.</li>
</ul>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/nanoframework/nanoframework.IoT.Device/blob/develop/devices/Mfrc522/README.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>


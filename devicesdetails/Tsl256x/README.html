<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>

  <head>
    <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <title>TSL256x/TSL2560/TSL2561 - Illuminance sensor | .NET nanoFramework Documentation </title>
      <meta name="viewport" content="width=device-width">
      <meta name="title" content="TSL256x/TSL2560/TSL2561 - Illuminance sensor | .NET nanoFramework Documentation ">
    

      <link rel="apple-touch-icon" sizes="180x180" href="../../favicons/apple-touch-icon.png">
      <link rel="icon" type="image/png" sizes="32x32" href="../../favicons/favicon-32x32.png">
      <link rel="icon" type="image/png" sizes="16x16" href="../../favicons/favicon-16x16.png">
      <link rel="manifest" href="../../favicons/site.webmanifest">
      <link rel="shortcut icon" type="image/x-icon" href="../../favicon.ico">
      <link rel="mask-icon" href="../../favicons/safari-pinned-tab.svg" color="#179b88">
      <meta name="msapplication-config" content="../../favicons/browserconfig.xml">
      <meta name="msapplication-TileColor" content="#222222">
      <meta name="theme-color" content="#222222">

      <link rel="stylesheet" href="../../styles/docfx.vendor.min.css">
      <link rel="stylesheet" href="../../styles/docfx.css">
      <link rel="stylesheet" href="../../styles/main.css">
      <meta property="docfx:navrel" content="../../toc.html">
      <meta property="docfx:tocrel" content="../../x-cross/toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>

        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">

        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">

        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="tsl256xtsl2560tsl2561---illuminance-sensor">TSL256x/TSL2560/TSL2561 - Illuminance sensor</h1>

<p>TSL2560 and TSL2561 are illuminance sensor. They are light-to-digital converters that transform light intensity to a digital signal output capable of direct I2C (TSL2561) or
SMBus (TSL2560) interface. Each device combines one broadband photodiode (visible plus infrared) and one infrared-responding photodiode on a single CMOS integrated circuit capable of providing a near-photopic response over an effective 20-bit dynamic range (16-bit resolution).</p>
<p>Two integrating ADCs convert the photodiode currents to a digital output that represents the irradiance measured on each channel. This digital output can be input to a microprocessor where illuminance (ambient light level) in lux is derived using an empirical formula to approximate the human eye response.</p>
<p>The TSL2560 device permits an SMB-Alert style interrupt, and the TSL2561 device supports a traditional level style interrupt that remains asserted until the firmware
clears it.</p>
<h2 id="documentation">Documentation</h2>
<ul>
<li>TSL256x <a href="https://cdn-shop.adafruit.com/datasheets/TSL2561.pdf">datasheet</a></li>
</ul>
<h2 id="board">Board</h2>
<p><img src="../../devicesimages/Tsl256x/Tsl256xBoard.png" alt="image"></p>
<h2 id="usage">Usage</h2>
<h3 id="basic-usage">Basic usage</h3>
<p>TSL2560 and TSL2561 are designed to have an integration time and a gain for measuring the 2 ADC. The defaults are 402 milliseconds and a normal gain of x1.</p>
<p>The basic usage is the following:</p>
<pre><code class="lang-csharp">I2cDevice i2cDevice = I2cDevice.Create(new I2cConnectionSettings(1, Tsl256x.DefaultI2cAddress));
Tsl256x tsl256X = new(i2cDevice, PackageType.Other);
tsl256X.IntegrationTime = IntegrationTime.Integration402Milliseconds;
tsl256X.Gain = Gain.Normal;
var lux = tsl256X.MeasureAndGetIlluminance();
Console.WriteLine($&quot;Illuminance is {lux.Lux} Lux&quot;);
</code></pre>
<p><strong>notes</strong>:</p>
<ul>
<li>Be aware, there are 2 types of packaging the CS and the Others T, FN and CL. Refer to the documentation to understand which package you have on the board. This is an argument when creating the sensor as the calculation for the illuminance is different.</li>
<li>There are 3 different possible I2C addresses for this device depending on how the address pin is setup:
<ul>
<li>DefaultI2cAddress = 0x39: When address pin is to the ground</li>
<li>SecondI2cAddress = 0x29: When address pin is floating</li>
<li>ThirdI2cAddress = 0x49: When address pin is to VDD</li>
</ul>
</li>
</ul>
<h3 id="check-the-version">Check the version</h3>
<p>You can determine if you have a TSL2560 or TSL2561 version:</p>
<pre><code class="lang-csharp">var ver = tsl256X.Version;
string msg = ver.Major &amp; 0x01 == 0x01 ? $&quot;This is a TSL2561, version {ver}&quot; : $&quot;This is a TSL2560, version {ver}&quot;;
Console.WriteLine(msg);
</code></pre>
<h3 id="using-interruptions">Using interruptions</h3>
<p>You can set interruptions, you have different possible ones you can set thru the <code>InterruptLevel</code>:</p>
<ul>
<li>OutputDisabled: will disable the interrupt</li>
<li>LevelInterrupt: will use the permanent interrupt you'll setup, see right after</li>
<li>SmbAlertCompliant: will send an alert on the SMB bus (version TSL2560 only) on address 0b0000_1100</li>
<li>TestMode: will generate an interruption for test purpose</li>
</ul>
<p>The <code>InterruptPersistence</code> will allow you to select a specific timing for the interrupt:</p>
<ul>
<li>EveryAdc: each time you have a measurement</li>
<li>AnyValueOutsideThreshold: any time a value will be outside of the setup threshold</li>
<li>OutOfRangeXXIntegrationTimePeriods: where XX is from 2 to 15, will interrupt only if the value remains outside more than XX times</li>
</ul>
<p>The following example shows how to setup a basic interruption using test mode:</p>
<pre><code class="lang-csharp">Console.WriteLine(&quot;Set interruption to test. Read the interrupt pin&quot;);
GpioController controller = new();
controller.OpenPin(PinInterrupt, PinMode.Input);
tsl256X.InterruptControl = InterruptControl.TestMode;
tsl256X.Enabled = true;
while (controller.Read(PinInterrupt) == PinValue.High)
{
    Thread.Sleep(1);
}

Console.WriteLine($&quot;Interrupt detected, read the value to clear the interrupt&quot;);
tsl256X.GetRawChannels(out ushort ch0, out ushort ch1);
</code></pre>
<p>You can setup interruptions on thresholds as well. You first need to setup a threshold and then the type of interruptions.</p>
<pre><code class="lang-csharp">// Adjust those values with a previous measurement to understand the conditions, find a level where then you can
// hide the sensor with your arm and make it going under the minimum level or vice versa with a lamp
tsl256X.SetThreshold(0x0000, 0x00FF);
tsl256X.InterruptPersistence = InterruptPersistence.OutOfRange06IntegrationTimePeriods;
tsl256X.InterruptControl = InterruptControl.LevelInterrupt;
tsl256X.Power = true;
while (controller.Read(PinInterrupt) == PinValue.High)
{
    Thread.Sleep(1);
}

Console.WriteLine($&quot;Interrupt detected, read the value to clear the interrupt&quot;);
tsl256X.GetRawChannels(out ch0, out ch1);
Console.WriteLine($&quot;Raw data channel 0 {ch0}, channel 1 {ch1}&quot;);
</code></pre>
<h3 id="manual-integration">Manual integration</h3>
<p>You can set a manual integration as well. Be aware that you won't be able to easily calculate an illuminance equivalent. You need to use the manual integration functions offered:</p>
<pre><code class="lang-csharp">Console.WriteLine(&quot;This will use a manual integration for 2 seconds&quot;);
tsl256X.StartManualIntegration();
Thread.Sleep(2000);
tsl256X.StopManualIntegration();
tsl256X.GetRawChannels(out ch0, out ch1);
Console.WriteLine($&quot;Raw data channel 0 {ch0}, channel 1 {ch1}&quot;);
</code></pre>

</article>
          </div>

          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/nanoframework/nanoframework.IoT.Device/blob/develop/devices\Tsl256x\README.md/#L1" class="contribution-link">Edit this page</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In this article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      
      <span>Copyright © 2023 nanoFramework Contributors<br>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>    </div>

    <script type="text/javascript" src="../../styles/docfx.vendor.min.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>


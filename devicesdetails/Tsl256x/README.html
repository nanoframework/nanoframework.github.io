<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
      <title>TSL256x/TSL2560/TSL2561 - Illuminance sensor | .NET nanoFramework Documentation </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="TSL256x/TSL2560/TSL2561 - Illuminance sensor | .NET nanoFramework Documentation ">
      
      
      <link rel="icon" href="../../favicon.ico">
      <link rel="stylesheet" href="../../public/docfx.min.css">
      <link rel="stylesheet" href="../../public/main.css">
      <meta name="docfx:navrel" content="../../toc.html">
      <meta name="docfx:tocrel" content="../../x-cross/toc.html">
      
      <meta name="docfx:rel" content="../../">
      
      
      <meta name="docfx:docurl" content="https://github.com/nanoframework/nanoframework.IoT.Device/blob/develop/devices/Tsl256x/README.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../index.html">
            <img id="logo" class="svg" src="../../logo.svg" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled="" placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="tsl256xtsl2560tsl2561---illuminance-sensor">TSL256x/TSL2560/TSL2561 - Illuminance sensor</h1>

<p>TSL2560 and TSL2561 are illuminance sensor. They are light-to-digital converters that transform light intensity to a digital signal output capable of direct I2C (TSL2561) or
SMBus (TSL2560) interface. Each device combines one broadband photodiode (visible plus infrared) and one infrared-responding photodiode on a single CMOS integrated circuit capable of providing a near-photopic response over an effective 20-bit dynamic range (16-bit resolution).</p>
<p>Two integrating ADCs convert the photodiode currents to a digital output that represents the irradiance measured on each channel. This digital output can be input to a microprocessor where illuminance (ambient light level) in lux is derived using an empirical formula to approximate the human eye response.</p>
<p>The TSL2560 device permits an SMB-Alert style interrupt, and the TSL2561 device supports a traditional level style interrupt that remains asserted until the firmware
clears it.</p>
<h2 id="documentation">Documentation</h2>
<ul>
<li>TSL256x <a href="https://cdn-shop.adafruit.com/datasheets/TSL2561.pdf">datasheet</a></li>
</ul>
<h2 id="board">Board</h2>
<p><img src="../../devicesimages/Tsl256x/Tsl256xBoard.png" alt="image"></p>
<h2 id="usage">Usage</h2>
<h3 id="basic-usage">Basic usage</h3>
<p>TSL2560 and TSL2561 are designed to have an integration time and a gain for measuring the 2 ADC. The defaults are 402 milliseconds and a normal gain of x1.</p>
<p>The basic usage is the following:</p>
<pre><code class="lang-csharp">I2cDevice i2cDevice = I2cDevice.Create(new I2cConnectionSettings(1, Tsl256x.DefaultI2cAddress));
Tsl256x tsl256X = new(i2cDevice, PackageType.Other);
tsl256X.IntegrationTime = IntegrationTime.Integration402Milliseconds;
tsl256X.Gain = Gain.Normal;
var lux = tsl256X.MeasureAndGetIlluminance();
Console.WriteLine($&quot;Illuminance is {lux.Lux} Lux&quot;);
</code></pre>
<p><strong>notes</strong>:</p>
<ul>
<li>Be aware, there are 2 types of packaging the CS and the Others T, FN and CL. Refer to the documentation to understand which package you have on the board. This is an argument when creating the sensor as the calculation for the illuminance is different.</li>
<li>There are 3 different possible I2C addresses for this device depending on how the address pin is setup:
<ul>
<li>DefaultI2cAddress = 0x39: When address pin is to the ground</li>
<li>SecondI2cAddress = 0x29: When address pin is floating</li>
<li>ThirdI2cAddress = 0x49: When address pin is to VDD</li>
</ul>
</li>
</ul>
<h3 id="check-the-version">Check the version</h3>
<p>You can determine if you have a TSL2560 or TSL2561 version:</p>
<pre><code class="lang-csharp">var ver = tsl256X.Version;
string msg = ver.Major &amp; 0x01 == 0x01 ? $&quot;This is a TSL2561, version {ver}&quot; : $&quot;This is a TSL2560, version {ver}&quot;;
Console.WriteLine(msg);
</code></pre>
<h3 id="using-interruptions">Using interruptions</h3>
<p>You can set interruptions, you have different possible ones you can set thru the <code>InterruptLevel</code>:</p>
<ul>
<li>OutputDisabled: will disable the interrupt</li>
<li>LevelInterrupt: will use the permanent interrupt you'll setup, see right after</li>
<li>SmbAlertCompliant: will send an alert on the SMB bus (version TSL2560 only) on address 0b0000_1100</li>
<li>TestMode: will generate an interruption for test purpose</li>
</ul>
<p>The <code>InterruptPersistence</code> will allow you to select a specific timing for the interrupt:</p>
<ul>
<li>EveryAdc: each time you have a measurement</li>
<li>AnyValueOutsideThreshold: any time a value will be outside of the setup threshold</li>
<li>OutOfRangeXXIntegrationTimePeriods: where XX is from 2 to 15, will interrupt only if the value remains outside more than XX times</li>
</ul>
<p>The following example shows how to setup a basic interruption using test mode:</p>
<pre><code class="lang-csharp">Console.WriteLine(&quot;Set interruption to test. Read the interrupt pin&quot;);
GpioController controller = new();
controller.OpenPin(PinInterrupt, PinMode.Input);
tsl256X.InterruptControl = InterruptControl.TestMode;
tsl256X.Enabled = true;
while (controller.Read(PinInterrupt) == PinValue.High)
{
    Thread.Sleep(1);
}

Console.WriteLine($&quot;Interrupt detected, read the value to clear the interrupt&quot;);
tsl256X.GetRawChannels(out ushort ch0, out ushort ch1);
</code></pre>
<p>You can setup interruptions on thresholds as well. You first need to setup a threshold and then the type of interruptions.</p>
<pre><code class="lang-csharp">// Adjust those values with a previous measurement to understand the conditions, find a level where then you can
// hide the sensor with your arm and make it going under the minimum level or vice versa with a lamp
tsl256X.SetThreshold(0x0000, 0x00FF);
tsl256X.InterruptPersistence = InterruptPersistence.OutOfRange06IntegrationTimePeriods;
tsl256X.InterruptControl = InterruptControl.LevelInterrupt;
tsl256X.Power = true;
while (controller.Read(PinInterrupt) == PinValue.High)
{
    Thread.Sleep(1);
}

Console.WriteLine($&quot;Interrupt detected, read the value to clear the interrupt&quot;);
tsl256X.GetRawChannels(out ch0, out ch1);
Console.WriteLine($&quot;Raw data channel 0 {ch0}, channel 1 {ch1}&quot;);
</code></pre>
<h3 id="manual-integration">Manual integration</h3>
<p>You can set a manual integration as well. Be aware that you won't be able to easily calculate an illuminance equivalent. You need to use the manual integration functions offered:</p>
<pre><code class="lang-csharp">Console.WriteLine(&quot;This will use a manual integration for 2 seconds&quot;);
tsl256X.StartManualIntegration();
Thread.Sleep(2000);
tsl256X.StopManualIntegration();
tsl256X.GetRawChannels(out ch0, out ch1);
Console.WriteLine($&quot;Raw data channel 0 {ch0}, channel 1 {ch1}&quot;);
</code></pre>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/nanoframework/nanoframework.IoT.Device/blob/develop/devices/Tsl256x/README.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>


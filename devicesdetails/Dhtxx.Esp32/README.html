<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
      <title>DHT10/DHT11/DHT12/DHT21/DHT22 for Esp32 using RMT - Digital-Output Relative Humidity &amp; Temperature Sensor Module | .NET nanoFramework Documentation </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="DHT10/DHT11/DHT12/DHT21/DHT22 for Esp32 using RMT - Digital-Output Relative Humidity &amp; Temperature Sensor Module | .NET nanoFramework Documentation ">
      
      
      <link rel="icon" href="../../favicon.ico">
      <link rel="stylesheet" href="../../public/docfx.min.css">
      <link rel="stylesheet" href="../../public/main.css">
      <meta name="docfx:navrel" content="../../toc.html">
      <meta name="docfx:tocrel" content="../../x-cross/toc.html">
      
      <meta name="docfx:rel" content="../../">
      
      
      <meta name="docfx:docurl" content="https://github.com/nanoframework/nanoframework.IoT.Device/blob/develop/devices/Dhtxx.Esp32/README.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../index.html">
            <img id="logo" class="svg" src="../../logo.svg" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="dht10dht11dht12dht21dht22-for-esp32-using-rmt---digital-output-relative-humidity--temperature-sensor-module">DHT10/DHT11/DHT12/DHT21/DHT22 for Esp32 using RMT - Digital-Output Relative Humidity &amp; Temperature Sensor Module</h1>

<blockquote>
<p><strong>IMPORTANT</strong> This implementation will only work on with ESP32. Don't use this implementation for those MCU.
This implementation requires 2 pins. One is used to write to the sensor and the other is used to read the data using RMT.</p>
</blockquote>
<p>The DHT temperature and humidity sensors are very popular. This projects support DHT10, DHT11, DHT12, DHT21(AM2301), DHT22(AM2302).</p>
<h2 id="documentation">Documentation</h2>
<table>
<thead>
<tr>
<th style="text-align: center;"></th>
<th style="text-align: center;">DHT10</th>
<th style="text-align: center;">DHT11</th>
<th style="text-align: center;">DHT12</th>
<th style="text-align: center;">DHT21</th>
<th style="text-align: center;">DHT22</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">Image</td>
<td style="text-align: center;"><img src="../../devicesimages/Dhtxx.Esp32/imgs/dht10.jpg" alt="dht10"></td>
<td style="text-align: center;"><img src="./imgs/dht11.jpg" alt="dht11"></td>
<td style="text-align: center;"><img src="./imgs/dht12.jpg" alt="dht12"></td>
<td style="text-align: center;"><img src="./imgs/dht21.jpg" alt="dht21"></td>
<td style="text-align: center;"><img src="./imgs/dht22.jpg" alt="dht22"></td>
</tr>
<tr>
<td style="text-align: center;">Temperature Range</td>
<td style="text-align: center;">-40 ~ 80 ℃</td>
<td style="text-align: center;">0 ~ 60 ℃</td>
<td style="text-align: center;">-20 ~ 60 ℃</td>
<td style="text-align: center;">-40 ~ 80 ℃</td>
<td style="text-align: center;">-40 ~ 80 ℃</td>
</tr>
<tr>
<td style="text-align: center;">Humidity Range</td>
<td style="text-align: center;">0 ~ 99.9 %</td>
<td style="text-align: center;">2 ~ 95 %</td>
<td style="text-align: center;">20 ~ 95 %</td>
<td style="text-align: center;">0 ~ 99.9 %</td>
<td style="text-align: center;">0 ~ 99.9 %</td>
</tr>
<tr>
<td style="text-align: center;">Temperature Accuracy</td>
<td style="text-align: center;">±0.5 ℃</td>
<td style="text-align: center;">±2 ℃</td>
<td style="text-align: center;">±0.5 ℃</td>
<td style="text-align: center;">±0.5 ℃</td>
<td style="text-align: center;">±0.5 ℃</td>
</tr>
<tr>
<td style="text-align: center;">Humidity Accuracy</td>
<td style="text-align: center;">±3 %</td>
<td style="text-align: center;">±5 %</td>
<td style="text-align: center;">±4 %</td>
<td style="text-align: center;">±3 %</td>
<td style="text-align: center;">±2 %</td>
</tr>
<tr>
<td style="text-align: center;">Protocol</td>
<td style="text-align: center;">I2C</td>
<td style="text-align: center;">1-Wire</td>
<td style="text-align: center;">I2C, 1-Wire</td>
<td style="text-align: center;">1-Wire</td>
<td style="text-align: center;">1-Wire</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>DHT10</strong> <a href="http://www.aosong.com/userfiles/files/media/DHT10%E8%A7%84%E6%A0%BC%E4%B9%A6.pdf">datasheet (Currently only Chinese)</a></li>
<li><strong>DHT11</strong> <a href="https://cdn.datasheetspdf.com/pdf-down/D/H/T/DHT11-Aosong.pdf">datasheet</a></li>
<li><strong>DHT12</strong> <a href="https://cdn.datasheetspdf.com/pdf-down/D/H/T/DHT12-Aosong.pdf">datasheet</a></li>
<li><strong>DHT21</strong> <a href="https://cdn.datasheetspdf.com/pdf-down/A/M/2/AM2301-Aosong.pdf">datasheet</a></li>
<li><strong>DHT22</strong> <a href="https://cdn-shop.adafruit.com/datasheets/DHT22.pdf">datasheet</a></li>
</ul>
<h2 id="usage">Usage</h2>
<h3 id="1-wire-protocol">1-Wire Protocol</h3>
<pre><code class="lang-csharp">// GPIO Pin
using (Dht11 dht = new Dht11(12, 24))
{
    var temperature = dht.Temperature;
    var humidity = dht.Humidity;
    // You can only display temperature and humidity if the read is successful otherwise, this will raise an exception as
    // both temperature and humidity are NAN
    if (dht.IsLastReadSuccessful)
    {
        Debug.WriteLine($&quot;Temperature: {temperature.DegreesCelsius} \u00B0C, Humidity: {humidity.Percent} %&quot;);

        // WeatherHelper supports more calculations, such as saturated vapor pressure, actual vapor pressure and absolute humidity.
        Debug.WriteLine(
            $&quot;Heat index: {WeatherHelper.CalculateHeatIndex(temperature, humidity).Celsius:0.#}\u00B0C&quot;);
        Debug.WriteLine(
            $&quot;Dew point: {WeatherHelper.CalculateDewPoint(temperature, humidity).Celsius:0.#}\u00B0C&quot;);
    }
    else
    {
        Debug.WriteLine(&quot;Error reading DHT sensor&quot;);
    }
}
</code></pre>
<p><strong>Note:</strong> <em>On the RPi with any of the DHT sensor, 1-Wire works using Raspian but not with Windows 10 IoT Core. The device has to switch the 1-wire pin between input and output and vice versa. It seems that Windows IoT Core OS can't switch the pin direction quick enough. There have been suggestions for using two pins; one for input and one for output. This solution has not been implemented here, but these are some handy links that may help setting that up:</em></p>
<ul>
<li><a href="https://github.com/ms-iot/samples/tree/develop/GpioOneWire">https://github.com/ms-iot/samples/tree/develop/GpioOneWire</a></li>
<li>And on Hackster.io: <a href="https://www.hackster.io/porrey/go-native-c-with-the-dht22-a8e8eb">https://www.hackster.io/porrey/go-native-c-with-the-dht22-a8e8eb</a></li>
</ul>
<h3 id="i2c-protocol">I2C Protocol</h3>
<p><strong>Important</strong>: make sure you properly setup the I2C pins especially for ESP32 before creating the <code>I2cDevice</code>, make sure you install the <code>nanoFramework.Hardware.ESP32 nuget</code>:</p>
<pre><code class="lang-csharp">//////////////////////////////////////////////////////////////////////
// when connecting to an ESP32 device, need to configure the I2C GPIOs
// used for the bus
Configuration.SetPinFunction(21, DeviceFunction.I2C1_DATA);
Configuration.SetPinFunction(22, DeviceFunction.I2C1_CLOCK);
</code></pre>
<p>For other devices like STM32, please make sure you're using the preset pins for the I2C bus you want to use.</p>
<p>Only DHT12 can use I2C protocol.</p>
<pre><code class="lang-csharp">I2cConnectionSettings settings = new I2cConnectionSettings(1, DhtSensor.DefaultI2cAddressDht12);
I2cDevice device = I2cDevice.Create(settings);

using (Dht12 dht = new Dht12(device))
{
    var tempValue = dht.Temperature;
    var humValue = dht.Humidity;
    if (dht.IsLastReadSuccessful)
    {
        Debug.WriteLine($&quot;Temperature: {tempValue.Celsius:0.#}\u00B0C&quot;);
        Debug.WriteLine($&quot;Relative humidity: {humValue:0.#}%&quot;);

        // WeatherHelper supports more calculations, such as saturated vapor pressure, actual vapor pressure and absolute humidity.
        Debug.WriteLine(
            $&quot;Heat index: {WeatherHelper.CalculateHeatIndex(tempValue, humValue).Celsius:0.#}\u00B0C&quot;);
        Debug.WriteLine(
            $&quot;Dew point: {WeatherHelper.CalculateDewPoint(tempValue, humValue).Celsius:0.#}\u00B0C&quot;);
    }
    else
    {
        Debug.WriteLine(&quot;Error reading DHT sensor&quot;);
    }
}
</code></pre>
<h2 id="reading-frequency-and-quality-measurement">Reading frequency and quality measurement</h2>
<p>In the case of I2C or GPIO, any type of DHT needs a bit of time between 2 readings. DHT22 documentation refer to a sensing period of 2 seconds and a collecting period higher than 1.7 seconds.
Measuring with higher frequency won't give you more accurate numbers. As you can see from the specifications, the accuracy depends on the sensor type, it goes from ±2 ℃ for the DHT11 to ±0.5 ℃ for the others.
Even if the parity check can come clear, we do recommend to check that the data are in a normal range. For example of humidity is higher than 100%, then it means that measurement is wrong.
This check has not been done in the binding itself, so you may consider adding a check on your application side.</p>
<p>The DHT sensors are very sensitive, avoid too long cables, electromagnetic perturbations and compile the code as release not debug to increase the quality of measurement.</p>
<h2 id="faq">FAQ</h2>
<p><strong>I always get wrong measurements, what's happening?</strong></p>
<p>Please check that the sensor is plugged correctly, make sure you are using the correct pin.</p>
<p>Please check you are using the correct sensor, only DHT10 and DHT12 supports I2C. All others support only GPIO with 1 wire protocol. DHT12 supports both.</p>
<p><strong>The data I measure are not correct, humidity seems ok but temperature is always weird, what's the problem?</strong></p>
<p>Please check you are using the correct sensor. Refer to the top part of this page to check which sensor you have. Using a DHT11 instead of a DHT22 will give you a wrong temperature.</p>
<p><strong>I am trying to get a temperature and humidity 5 times per seconds but I mainly get wrong measurements, why?</strong></p>
<p>This is absolutely normal, you should check the measurements once every 2 seconds approximately. Don't try to get more measures than once every 2 seconds.</p>
<p><strong>When reading the temperature and humidity and trying to write the data in the console, I get an exception, why?</strong></p>
<p>You need to check first if the measurement has been successful. If the measurement hasn't been successful, the default values will be NaN and so you won't be able to convert the temperature or humidity and you'll get an exception. This is the correct way of first reading the sensor and then checking the reading was correct and finally using the temperature and humidity data:</p>
<pre><code class="lang-csharp">var tempValue = dht.Temperature;
var humValue = dht.Humidity;
if (dht.IsLastReadSuccessful)
{
    Debug.WriteLine($&quot;Temperature: {tempValue.Celsius:0.#}\u00B0C&quot;);
    Debug.WriteLine($&quot;Relative humidity: {humValue:0.#}%&quot;);
}
</code></pre>
<h2 id="example-of-dhtxx">Example of DHTxx</h2>
<h3 id="hardware-required">Hardware Required</h3>
<ul>
<li>DHT10/DHT11/DHT12/DHT21/DHT22</li>
<li>Male/Female Jumper Wires</li>
</ul>
<h3 id="circuit">Circuit</h3>
<h4 id="1-wire-protocol-circuit">1-Wire Protocol Circuit</h4>
<p>Simply connect your DHTxx data pin to GPIO12 and GPIO14, the ground to the ground and the VCC to +3.3V.</p>
<p><img src="../../devicesimages/Dhtxx.Esp32/dht22.png" alt="schema"></p>
<p>Some sensors are already sold with the 10K resistor. Connect the both GPIO12 and GPIO14 to the <em>data</em> pin, its position can vary depending on the integrator.</p>
<h4 id="i2c-protocol-circuit">I2C Protocol Circuit</h4>
<p><img src="../../devicesimages/Dhtxx.Esp32/DHT12_circuit_bb.png" alt="schematics"></p>
<ul>
<li>SCL - SCL</li>
<li>SDA - SDA</li>
<li>VCC - 5V</li>
<li>GND - GND</li>
</ul>
<h3 id="code">Code</h3>
<pre><code class="lang-csharp">// GPIO Pin
using (Dht11 dht = new Dht11(26))
{
    var temperature = dht.Temperature;
    var humidity = dht.Humidity;
    // You can only display temperature and humidity if the read is successful otherwise, this will raise an exception as
    // both temperature and humidity are NAN
    if (dht.IsLastReadSuccessful)
    {
        Debug.WriteLine($&quot;Temperature: {temperature.DegreesCelsius} \u00B0C, Humidity: {humidity.Percent} %&quot;);

        // WeatherHelper supports more calculations, such as saturated vapor pressure, actual vapor pressure and absolute humidity.
        Debug.WriteLine(
            $&quot;Heat index: {WeatherHelper.CalculateHeatIndex(temperature, humidity).Celsius:0.#}\u00B0C&quot;);
        Debug.WriteLine(
            $&quot;Dew point: {WeatherHelper.CalculateDewPoint(temperature, humidity).Celsius:0.#}\u00B0C&quot;);
    }
    else
    {
        Debug.WriteLine(&quot;Error reading DHT sensor&quot;);
    }
}
</code></pre>
<h3 id="sample-application-navigation">Sample application navigation</h3>
<p>This sample application allows you to select either a DHT10 through I2C either any other supported DHT through GPIO:</p>
<pre><code class="lang-text">Select the DHT sensor you want to use:
 1. DHT10 on I2C
 2. DHT11 on GPIO
 3. DHT12 on GPIO
 4. DHT21 on GPIO
 5. DHT22 on GPIO
</code></pre>
<p>Just adjust the <code>device</code> variable. For example, if you want to test a DHT22, adjust it to 5.</p>
<pre><code class="lang-csharp">// Set these values to test according to the list below:
var pinEcho = 12;
var pinTrigger = 14;
var device = 5;
</code></pre>
<p>This samples uses the pins 12 and 14. If you want to use the pin 26 and 10, then adjust the <code>pinEcho</code> and <code>pinTrigger</code> variables. This will then create a DHT22 sensor attached to pin 26 and start the measurement.</p>
<p>Please note that the few first measurements won't be correct, that's totally normal and related to the fact the sensor needs a bit of time to warm up and give data. Those sensors are very sensitive and too long wires, many perturbations, code compile as debug will increase the numbers of bad readings.</p>
<h3 id="result">Result</h3>
<p><img src="../../devicesimages/Dhtxx.Esp32/dht22ex.jpg" alt="dht22 output"></p>
<p>Note: reading this sensor is sensitive, if you can't read anything, make sure you have it correctly cabled. Also note you'll get better results when running in <code>Release</code> mode.</p>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/nanoframework/nanoframework.IoT.Device/blob/develop/devices/Dhtxx.Esp32/README.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>

